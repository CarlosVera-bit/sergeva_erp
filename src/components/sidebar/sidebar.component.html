<!-- Sidebar - Responsive con overlay en móvil y contraíble en desktop -->
<aside
  class="fixed md:relative top-0 left-0 z-40 w-72 h-full bg-gradient-to-b from-slate-50 to-white dark:from-slate-900 dark:to-slate-800 border-r border-slate-200/80 dark:border-slate-700/50 flex flex-col shadow-2xl shadow-slate-900/10 dark:shadow-black/30 transition-all duration-300 ease-in-out md:translate-x-0"
  [class.-translate-x-full]="!isMobileMenuOpen()" [class.translate-x-0]="isMobileMenuOpen()"
  [class.md:w-20]="isCollapsed()" [class.md:w-72]="!isCollapsed()">

  <!-- Header con logo y nombre - solo visible en móvil -->
  <div
    class="flex md:hidden items-center justify-between p-4 border-b border-slate-200/80 dark:border-slate-700/50 bg-white/50 dark:bg-slate-800/50 backdrop-blur-sm">
    <div class="flex items-center">
      <img src="assets/images/logo.png" alt="Logo Sergeva" class="h-14 w-auto object-contain">
    </div>

    <!-- Close button -->
    <button (click)="closeMobileMenu()"
      class="p-2.5 rounded-xl text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all duration-200 hover:scale-105">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </div>

  <!-- Navigation -->
  <nav class="flex-1 overflow-y-auto px-3 py-4 md:px-3 md:py-4" [class.md:px-2]="isCollapsed()"
    [class.md:py-3]="isCollapsed()">

    <!-- Sección Principal -->
    @if (principalItems().length > 0) {
    <div class="mb-6">
      <p class="px-4 mb-3 text-[11px] font-bold uppercase tracking-wider text-slate-400 dark:text-slate-500"
        [class.md:hidden]="isCollapsed()">Principal</p>
      @for (item of principalItems(); track item.id) {
      <a [routerLink]="item.route"
        routerLinkActive="!bg-gradient-to-r !from-primary-500 !to-primary-600 !text-white !shadow-lg !shadow-primary-500/30 !border-transparent [&_.icon-box]:!bg-white/20 [&_.icon-box]:!text-white"
        class="group relative flex items-center gap-3 px-4 py-3.5 mb-1.5 rounded-xl transition-all duration-300 ease-out text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50 hover:text-slate-900 dark:hover:text-white border border-transparent hover:border-slate-200 dark:hover:border-slate-600 hover:shadow-md"
        [class.md:px-3]="isCollapsed()" [class.md:py-3.5]="isCollapsed()" [class.md:justify-center]="isCollapsed()"
        [title]="isCollapsed() ? item.label : ''" (click)="closeMobileMenu()">
        <div
          class="icon-box relative flex-shrink-0 p-2 rounded-lg bg-primary-100 dark:bg-primary-900/40 text-primary-600 dark:text-primary-400 group-hover:bg-primary-200 dark:group-hover:bg-primary-800/50 transition-all duration-300">
          <span [innerHTML]="item.icon"
            class="flex items-center justify-center [&>svg]:w-5 [&>svg]:h-5 transition-transform duration-300 group-hover:scale-110"></span>
        </div>
        <span class="font-semibold text-[15px] whitespace-nowrap md:hidden">{{ item.label }}</span>
        @if (!isCollapsed()) {
        <span class="hidden md:inline font-semibold text-[15px] whitespace-nowrap">{{ item.label }}</span>
        }
        @if (isCollapsed()) {
        <div
          class="hidden md:block absolute left-full ml-3 px-4 py-2.5 bg-slate-900 dark:bg-slate-700 text-white text-sm font-semibold rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50 pointer-events-none">
          {{ item.label }}
          <div
            class="absolute right-full top-1/2 -translate-y-1/2 border-[6px] border-transparent border-r-slate-900 dark:border-r-slate-700">
          </div>
        </div>
        }
      </a>
      }
    </div>

    <!-- Separador -->
    <div class="mx-4 mb-6 border-t border-slate-200 dark:border-slate-700/50" [class.md:mx-2]="isCollapsed()"></div>
    }

    <!-- Sección Operaciones -->
    @if (operationsItems().length > 0) {
    <div class="mb-6">
      <p class="px-4 mb-3 text-[11px] font-bold uppercase tracking-wider text-slate-400 dark:text-slate-500"
        [class.md:hidden]="isCollapsed()">Operaciones</p>
      @for (item of operationsItems(); track item.id) {
      <a [routerLink]="item.route"
        routerLinkActive="!bg-gradient-to-r !from-primary-500 !to-primary-600 !text-white !shadow-lg !shadow-primary-500/30 !border-transparent [&_.icon-box]:!bg-white/20 [&_.icon-box]:!text-white"
        class="group relative flex items-center gap-3 px-4 py-3.5 mb-1.5 rounded-xl transition-all duration-300 ease-out text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50 hover:text-slate-900 dark:hover:text-white border border-transparent hover:border-slate-200 dark:hover:border-slate-600 hover:shadow-md"
        [class.md:px-3]="isCollapsed()" [class.md:py-3.5]="isCollapsed()" [class.md:justify-center]="isCollapsed()"
        [title]="isCollapsed() ? item.label : ''" (click)="closeMobileMenu()">
        <div
          class="icon-box relative flex-shrink-0 p-2 rounded-lg bg-slate-100 dark:bg-slate-700/70 text-slate-500 dark:text-slate-400 group-hover:bg-primary-100 dark:group-hover:bg-primary-900/40 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-all duration-300">
          <span [innerHTML]="item.icon"
            class="flex items-center justify-center [&>svg]:w-5 [&>svg]:h-5 transition-transform duration-300 group-hover:scale-110"></span>
        </div>
        <span class="font-semibold text-[15px] whitespace-nowrap md:hidden">{{ item.label }}</span>
        @if (!isCollapsed()) {
        <span class="hidden md:inline font-semibold text-[15px] whitespace-nowrap">{{ item.label }}</span>
        }
        @if (isCollapsed()) {
        <div
          class="hidden md:block absolute left-full ml-3 px-4 py-2.5 bg-slate-900 dark:bg-slate-700 text-white text-sm font-semibold rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50 pointer-events-none">
          {{ item.label }}
          <div
            class="absolute right-full top-1/2 -translate-y-1/2 border-[6px] border-transparent border-r-slate-900 dark:border-r-slate-700">
          </div>
        </div>
        }
      </a>
      }
    </div>

    <!-- Separador -->
    <div class="mx-4 mb-6 border-t border-slate-200 dark:border-slate-700/50" [class.md:mx-2]="isCollapsed()"></div>
    }

    <!-- Sección Registros -->
    @if (registrosItems().length > 0) {
    <div class="mb-6">
      <p class="px-4 mb-3 text-[11px] font-bold uppercase tracking-wider text-slate-400 dark:text-slate-500"
        [class.md:hidden]="isCollapsed()">Registros</p>
      @for (item of registrosItems(); track item.id) {
      <a [routerLink]="item.route"
        routerLinkActive="!bg-gradient-to-r !from-primary-500 !to-primary-600 !text-white !shadow-lg !shadow-primary-500/30 !border-transparent [&_.icon-box]:!bg-white/20 [&_.icon-box]:!text-white"
        class="group relative flex items-center gap-3 px-4 py-3.5 mb-1.5 rounded-xl transition-all duration-300 ease-out text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50 hover:text-slate-900 dark:hover:text-white border border-transparent hover:border-slate-200 dark:hover:border-slate-600 hover:shadow-md"
        [class.md:px-3]="isCollapsed()" [class.md:py-3.5]="isCollapsed()" [class.md:justify-center]="isCollapsed()"
        [title]="isCollapsed() ? item.label : ''" (click)="closeMobileMenu()">
        <div
          class="icon-box relative flex-shrink-0 p-2 rounded-lg bg-slate-100 dark:bg-slate-700/70 text-slate-500 dark:text-slate-400 group-hover:bg-primary-100 dark:group-hover:bg-primary-900/40 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-all duration-300">
          <span [innerHTML]="item.icon"
            class="flex items-center justify-center [&>svg]:w-5 [&>svg]:h-5 transition-transform duration-300 group-hover:scale-110"></span>
        </div>
        <span class="font-semibold text-[15px] whitespace-nowrap md:hidden">{{ item.label }}</span>
        @if (!isCollapsed()) {
        <span class="hidden md:inline font-semibold text-[15px] whitespace-nowrap">{{ item.label }}</span>
        }
        @if (isCollapsed()) {
        <div
          class="hidden md:block absolute left-full ml-3 px-4 py-2.5 bg-slate-900 dark:bg-slate-700 text-white text-sm font-semibold rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50 pointer-events-none">
          {{ item.label }}
          <div
            class="absolute right-full top-1/2 -translate-y-1/2 border-[6px] border-transparent border-r-slate-900 dark:border-r-slate-700">
          </div>
        </div>
        }
      </a>
      }
    </div>

    <!-- Separador -->
    <div class="mx-4 mb-6 border-t border-slate-200 dark:border-slate-700/50" [class.md:mx-2]="isCollapsed()"></div>
    }

    <!-- Sección Administración -->
    @if (adminItems().length > 0) {
    <div class="mb-2">
      <p class="px-4 mb-3 text-[11px] font-bold uppercase tracking-wider text-slate-400 dark:text-slate-500"
        [class.md:hidden]="isCollapsed()">Administración</p>
      @for (item of adminItems(); track item.id) {
      <a [routerLink]="item.route"
        routerLinkActive="!bg-gradient-to-r !from-primary-500 !to-primary-600 !text-white !shadow-lg !shadow-primary-500/30 !border-transparent [&_.icon-box]:!bg-white/20 [&_.icon-box]:!text-white"
        class="group relative flex items-center gap-3 px-4 py-3.5 mb-1.5 rounded-xl transition-all duration-300 ease-out text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700/50 hover:text-slate-900 dark:hover:text-white border border-transparent hover:border-slate-200 dark:hover:border-slate-600 hover:shadow-md"
        [class.md:px-3]="isCollapsed()" [class.md:py-3.5]="isCollapsed()" [class.md:justify-center]="isCollapsed()"
        [title]="isCollapsed() ? item.label : ''" (click)="closeMobileMenu()">
        <div
          class="icon-box relative flex-shrink-0 p-2 rounded-lg bg-slate-100 dark:bg-slate-700/70 text-slate-500 dark:text-slate-400 group-hover:bg-primary-100 dark:group-hover:bg-primary-900/40 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-all duration-300">
          <span [innerHTML]="item.icon"
            class="flex items-center justify-center [&>svg]:w-5 [&>svg]:h-5 transition-transform duration-300 group-hover:scale-110"></span>
        </div>
        <span class="font-semibold text-[15px] whitespace-nowrap md:hidden">{{ item.label }}</span>
        @if (!isCollapsed()) {
        <span class="hidden md:inline font-semibold text-[15px] whitespace-nowrap">{{ item.label }}</span>
        }
        @if (isCollapsed()) {
        <div
          class="hidden md:block absolute left-full ml-3 px-4 py-2.5 bg-slate-900 dark:bg-slate-700 text-white text-sm font-semibold rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50 pointer-events-none">
          {{ item.label }}
          <div
            class="absolute right-full top-1/2 -translate-y-1/2 border-[6px] border-transparent border-r-slate-900 dark:border-r-slate-700">
          </div>
        </div>
        }
      </a>
      }
    </div>
    }
  </nav>

  <!-- Toggle button para contraer/expandir - solo visible en desktop -->
  <div
    class="hidden md:block border-t border-slate-200/80 dark:border-slate-700/50 p-3 bg-slate-50/50 dark:bg-slate-800/50"
    [class.md:p-2]="isCollapsed()">
    <button (click)="toggleCollapse()"
      class="group w-full flex items-center justify-center gap-2 rounded-xl p-3 text-slate-500 dark:text-slate-400 bg-white dark:bg-slate-700/50 hover:bg-primary-50 dark:hover:bg-primary-900/30 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-300 border border-slate-200 dark:border-slate-600 hover:border-primary-300 dark:hover:border-primary-700 hover:shadow-lg hover:shadow-primary-500/10"
      [class.md:justify-center]="isCollapsed()" [title]="isCollapsed() ? 'Expandir menú' : 'Contraer menú'">
      @if (!isCollapsed()) {
      <svg class="w-5 h-5 transition-transform duration-300 group-hover:-translate-x-0.5" fill="none"
        stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7" />
      </svg>
      <span class="text-sm font-semibold">Contraer</span>
      }
      @if (isCollapsed()) {
      <svg class="w-5 h-5 rotate-180 transition-transform duration-300 group-hover:translate-x-0.5" fill="none"
        stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7" />
      </svg>
      }
    </button>
  </div>
</aside>

<!-- Overlay backdrop para móvil -->
@if (isMobileMenuOpen()) {
<div class="fixed inset-0 bg-black/60 backdrop-blur-sm z-30 md:hidden transition-opacity duration-300"
  (click)="closeMobileMenu()">
</div>
}